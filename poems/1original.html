<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÙŠØ§ Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø³Ù„</title>
  <link rel="icon" type="image/png" href="/images/logo.ico" sizes="32x32">
  <style>
    body {
      display: flex;
      justify-content: center;
      margin: 0;
      background-color: #f5f5f5;
      font-family: Arial, sans-serif;
      min-height: 100vh;
      position: relative;
      transition: background-color 0.3s, color 0.3s;
      color: #000;
    }

    .container {
      background: white;
      padding: 40px 60px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      text-align: center;
      position: relative;
      transition: background-color 0.3s, color 0.3s;
      color: #000;
      width: 600px;
      max-width: 90vw;
    }

    .font-size-controls {
      position: absolute;
      top: 40px;
      right: 60px;
      display: flex;
      flex-direction: row;
      gap: 10px;
      z-index: 2;
    }

    /* Top-left share, translation, transliteration buttons */
    .top-left-buttons {
      position: absolute;
      top: 40px;
      left: 170px;
      display: flex;
      flex-direction: row;
      gap: 10px;
      z-index: 2;
    }
    .button {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 50%;
      background-color: #256328;
      color: white;
      text-decoration: none;
      font-size: 1rem;
      border: none;
      cursor: pointer;
      user-select: none;
      outline: none;
      transition: background 0.2s, color 0.3s;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    /* Tooltip styles for buttons using data-tooltip attribute */
    .button[data-tooltip]:hover:after, .button[data-tooltip]:focus:after {
      content: attr(data-tooltip);
      position: absolute;
      left: 50%;
      top: 110%;
      transform: translateX(-50%);
      background: #222;
      color: #fff;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.85em;
      white-space: nowrap;
      pointer-events: none;
      z-index: 3000;
      opacity: 0.92;
    }
    .button:hover {
      background-color: #254563;
    }
    .back-button {
      position: absolute;
      top: 40px;
      left: 60px;
      z-index: 2;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      padding: 0;
      font-size: 1.2rem;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container p {
      margin: 15px 0;
      line-height: 2;
      direction: rtl;
      text-align: center;
      font-size: 1.2rem;
      transition: color 0.3s;
    }
    /* Alternate line colour for paragraphs with .alt class */
    .container p.alt {
      color: #256328;
    }
    .container .translation {
      font-size: 0.8em;
      font-style: normal;
      color: #444;
      direction: ltr;
      text-align: center;
      margin-top: 0.3em;
      margin-bottom: 0.8em;
      font-family: Arial, sans-serif;
      display: none;
      transition: color 0.3s;
    }
    .container .transliteration {
      font-size: 0.9em;
      font-style: italic;
      color: #666;
      direction: ltr;
      text-align: center;
      margin-top: -0.4em;
      margin-bottom: 0.7em;
      font-family: "Times New Roman", Times, serif;
      display: none;
      transition: color 0.3s;
    }
    @font-face {
      font-family: "Diwan Thuluth";
      src: url("/fonts/DiwanThuluth.ttf") format("truetype");
    }

    @font-face {
      font-family: "Al Bayan";
      src: url("/fonts/AlBayan.ttc") format("truetype");
    }

        @font-face {
      font-family: "Al Bayan";
      src: url("/fonts/AlTarikh.ttc") format("truetype");
    }

    h1 {
      font-family: "Diwan Thuluth", serif;
      transition: color 0.3s;
      color: #C99F35;
    }

    .container p {
      font-family: "Al Bayan", sans-serif;
            color: #6A7786
    }

    /* Dark mode styles */
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }

    body.dark-mode .container {
      background-color: #1e1e1e;
      color: #e0e0e0;
      box-shadow: 0 4px 10px rgba(255,255,255,0.1);
    }

    body.dark-mode .container p {
      color: #e0e0e0;
    }
    body.dark-mode .container p.alt {
      color: #53A2A9;
    }
    body.dark-mode .container .translation {
      color: #b8e1f2;
    }
    body.dark-mode .container .transliteration {
      color: #b7b7b7;
    }

    body.dark-mode h1 {
      color: #53A2A9;
    }

    body.dark-mode .button {
      background-color: #444;
      color: #e0e0e0;
    }

    body.dark-mode .button:hover {
      background-color: #666;
    }
body {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  margin: 0;
  background-color: #f5f5f5;
  font-family: Arial, sans-serif;
  min-height: 100vh;
  position: relative;
  transition: background-color 0.3s, color 0.3s;
  color: #000;
}

.page-layout {
  display: flex;
  align-items: stretch; /* makes nav-pane and container same height */
  gap: 30px; /* spacing between nav and content */
}

.nav-pane {
  background: white;
  color: #000;
  border-radius: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  padding: 40px 40px;
  margin-right: 30px;
  width: 220px;
  max-width: 90vw;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  transition: transform 0.3s ease-in-out;
}

.nav-pane ul {
  list-style: none;
  padding: 0;
  margin: 0;
  width: 100%;
}

.nav-pane li {
  margin: 18px 0;
  width: 100%;
  text-align: center;
}

.nav-pane a {
  color: #256328;
  text-decoration: none;
  font-size: 1.1rem;
  padding: 8px 24px;
  border-radius: 8px;
  display: block;
  transition: background 0.2s, color 0.2s;
}

    .nav-pane a:hover,
    .nav-pane a.active {
      background: #254563;
      color: #fff;
    }

    #searchInput {
      width: 90%;
      padding: 8px;
      margin-bottom: 20px;
      border-radius: 8px;
      border: 1px solid #ccc;
      text-align: left;
      background: #fff;
      color: #000;
      transition: background 0.3s, color 0.3s, border-color 0.3s;
    }

    body.dark-mode #searchInput {
      background: #333;
      color: #e0e0e0;
      border: 1px solid #555;
    }

/* Dark mode for nav-pane */
body.dark-mode .nav-pane {
  background: #1e1e1e;
  color: #e0e0e0;
  box-shadow: 0 4px 10px rgba(255,255,255,0.1);
}

body.dark-mode .nav-pane a {
  color: #53A2A9;
}

body.dark-mode .nav-pane a:hover,
body.dark-mode .nav-pane a.active {
  background: #53A2A9;
  color: #1e1e1e;
}

/* Share menu modal styles */
#shareMenu {
  position: absolute;
  top: 85px;
  left: 500px;
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  width: 180px;
  display: none;
  flex-direction: column;
  z-index: 1000;
  font-family: Arial, sans-serif;
}

#shareMenu button {
  background: none;
  border: none;
  padding: 12px 20px;
  text-align: right;
  font-size: 1rem;
  cursor: pointer;
  color: #256328;
  border-bottom: 1px solid #eee;
  transition: background 0.2s, color 0.2s;
  user-select: none;
}

#shareMenu button:last-child {
  border-bottom: none;
}

#shareMenu button:hover {
  background: #254563;
  color: #fff;
  border-radius: 10px;
}

/* Dark mode for share menu */
body.dark-mode #shareMenu {
  background: #1e1e1e;
  color: #e0e0e0;
  box-shadow: 0 4px 12px rgba(255,255,255,0.2);
}

body.dark-mode #shareMenu button {
  color: #53A2A9;
  border-color: #333;
}

body.dark-mode #shareMenu button:hover {
  background: #53A2A9;
  color: #1e1e1e;
}

/* Responsive styles for small screens */
@media (max-width: 768px) {
  .nav-pane {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    margin: 0;
    padding: 40px 20px;
    width: 250px;
    max-width: 80vw;
    box-shadow: 2px 0 8px rgba(0,0,0,0.3);
    transform: translateX(-100%);
    z-index: 2000;
    background: white;
    transition: transform 0.3s ease-in-out;
  }
  body.dark-mode .nav-pane {
    background: #1e1e1e;
  }
  .nav-pane.show {
    transform: translateX(0);
  }
  .page-layout {
    gap: 0;
  }
  .container {
    width: 100%;
    max-width: 100vw;
    padding: 40px 20px 60px 20px;
  }
  .back-button {
    left: 60px;
  }
  #shareButton {
    left: 110px;
  }
  /* Hamburger button styles */
  .hamburger-button {
    position: absolute;
    top: 40px;
    left: 10px;
    z-index: 2100;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    padding: 0;
    font-size: 1.5rem;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #256328;
    color: white;
    border: none;
    cursor: pointer;
    user-select: none;
    outline: none;
    transition: background 0.2s, color 0.3s;
  }
  .hamburger-button:hover {
    background-color: #254563;
  }
}

/* Hide hamburger button on larger screens */
@media (min-width: 769px) {
  .hamburger-button {
    display: none;
  }
}
    /* Traditional chorus box style */
    .chorus-box {
      background-color: #fff8e1; /* soft parchment-like background */
      border: 2px solid #c99f35; /* golden frame-like border */
      border-radius: 12px;
      padding: 5px 10px;
      margin: 20px 0;
      font-family: "Al Bayan", serif; 
      font-size: 1.25rem;
      font-style: normal;
      text-align: center;
      line-height: 2;
      box-shadow: inset 0 0 10px rgba(200, 159, 53, 0.2);
      position: relative;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }

    /* Dark mode for chorus box */
    body.dark-mode .chorus-box {
      background-color: #2b2b1f; /* dark parchment */
      border-color: #53a2a9;
      color: #e0e0e0;
      box-shadow: inset 0 0 10px rgba(83, 162, 169, 0.2);
    }

    /* Decorative marks above and below chorus */
    .chorus-box::before,
    .chorus-box::after {
      content: "Û";
      display: block;
      font-size: 1.5rem;
      color: #c99f35;
      margin: 6px 0;
    }

    body.dark-mode .chorus-box::before,
    body.dark-mode .chorus-box::after {
      color: #53a2a9;
    }
        /* Filter tag buttons container and button styles */
    #tagFilterContainer {
      width: 100%;
      margin-bottom: 20px;
      overflow-x: auto;
      white-space: nowrap;
      padding-bottom: 6px;
      text-align: left;
      box-sizing: border-box;
    }
    .filter-button {
      display: inline-block;
      margin: 0 6px 6px 0;
      padding: 6px 16px;
      border-radius: 18px;
      background-color: #e0e9e3;
      color: #256328;
      border: none;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      outline: none;
      font-family: inherit;
      box-shadow: 0 1px 3px rgba(37,99,40,0.05);
    }
    .filter-button.active,
    .filter-button:focus {
      background-color: #256328;
      color: #fff;
    }
    .filter-button:hover:not(.active) {
      background-color: #c8dbcf;
    }

    body.dark-mode #tagFilterContainer {
      background: transparent;
    }
    body.dark-mode .filter-button {
      background-color: #2a3f2d;
      color: #53A2A9;
    }
    body.dark-mode .filter-button.active,
    body.dark-mode .filter-button:focus {
      background-color: #53A2A9;
      color: #1e1e1e;
    }
    body.dark-mode .filter-button:hover:not(.active) {
      background-color: #256328;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="page-layout">
    <nav class="nav-pane" id="navPane">
      <input 
        type="text" 
        id="searchInput" 
        placeholder="ğŸ” Search"
      />
      <div id="tagFilterContainer"></div>
      <ul id="poemList">

      </ul>
    </nav>
    <div class="container" data-disable-chorus="true">
      <button class="button hamburger-button" id="hamburgerButton" aria-label="Toggle navigation menu">â˜°</button>
      <button id="shareButton" class="button back-button" style="left: 60px;" title="Share">ğŸ“¤</button>
      <button id="translationToggle" class="button back-button" style="left: 110px;" data-tooltip="Toggle Translation">ğŸŒ</button>
      <button id="transliterationToggle" class="button back-button" style="left: 160px;" data-tooltip="Toggle Transliteration">ğŸ”¤</button>
      <div class="font-size-controls">
        <button class="button" onclick="changeFontSize(1)" data-tooltip="ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·">+</button>
        <button class="button" onclick="changeFontSize(-1)" data-tooltip="ØªØµØºÙŠØ± Ø§Ù„Ø®Ø·">-</button>
        <button class="button" id="darkModeToggle" title="Toggle Dark Mode" data-tooltip="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ">ğŸŒ“</button>
      </div>
      <h1>ÙŠØ§ Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø³Ù„</h1>

      <!-- Chorus Box -->
      <div class="chorus-box">
        <p>ÙŠÙÙ€Ù€Ø§ Ø¥ÙÙ…ÙÙ€Ù€Ø§Ù…Ù Ø§Ù„Ù€Ù€Ø±ÙÙ‘Ø³ÙÙ€Ù€Ù„Ù ÙŠÙÙ€Ù€Ø§ Ø³ÙÙ€Ù€Ù†ÙÙ€Ù€Ø¯ÙÙŠ Û Ø£ÙÙ†Ù’Ù€Ù€ØªÙ Ø¨ÙÙ€Ù€Ù€Ø§Ø¨Ù Ø§Ù„Ù€Ù€Ù„Ù€Ù€Ù‡Ù Ù…ÙÙ€Ù€Ø¹Ù’Ù€Ù€ØªÙÙ€Ù€Ù…ÙÙ€Ù€Ø¯ÙÙŠ</p>
        <p>ÙÙÙ€Ù€Ø¨ÙÙ€Ù€Ø¯ÙÙ†Ù’Ù€Ù€ÙŠÙÙ€Ù€Ø§ÙŠÙ ÙˆÙØ¢Ø®ÙÙ€Ù€Ø±ÙØªÙÙ€Ù€ÙŠ Û ÙŠÙÙ€Ù€Ø§Ø±ÙØ³ÙÙ€Ù€ÙˆÙ„Ù Ø§Ù„Ù€Ù€Ù„Ù€Ù€Ù‡Ù Ø®ÙÙ€Ù€Ø°Ù’ Ø¨ÙÙ€Ù€ÙŠÙÙ€Ù€Ø¯ÙÙŠ</p>     
      </div>

      <!-- Poem Input -->
      <p>ÙŠÙÙ€Ù€Ø§ Ø¥ÙÙ…ÙÙ€Ù€Ø§Ù…Ù Ø§Ù„Ù€Ù€Ø±ÙÙ‘Ø³ÙÙ€Ù€Ù„Ù ÙŠÙÙ€Ù€Ø§ Ø³ÙÙ€Ù€Ù†ÙÙ€Ù€Ø¯ÙÙŠ Û Ø£ÙÙ†Ù’Ù€Ù€ØªÙ Ø¨ÙÙ€Ù€Ù€Ø§Ø¨Ù Ø§Ù„Ù€Ù€Ù„Ù€Ù€Ù‡Ù Ù…ÙÙ€Ù€Ø¹Ù’Ù€Ù€ØªÙÙ€Ù€Ù…ÙÙ€Ù€Ø¯ÙÙŠ</p>
      <div class="transliteration">Ya Imaam al-rusuli ya sanadÄ« Û Anta baabullÄhi muâ€˜tamadi</div>
      <div class="translation">O leader of the messengers, O my support Û You are Allahâ€™s gateway, my reliance</div>
      <p>ÙÙÙ€Ù€Ø¨ÙÙ€Ù€Ø¯ÙÙ†Ù’Ù€Ù€ÙŠÙÙ€Ù€Ø§ÙŠÙ ÙˆÙØ¢Ø®ÙÙ€Ù€Ø±ÙØªÙÙ€Ù€ÙŠ Û ÙŠÙÙ€Ù€Ø§Ø±ÙØ³ÙÙ€Ù€ÙˆÙ„Ù Ø§Ù„Ù€Ù€Ù„Ù€Ù€Ù‡Ù Ø®ÙÙ€Ù€Ø°Ù’ Ø¨ÙÙ€Ù€ÙŠÙÙ€Ù€Ø¯ÙÙŠ</p>
      <div class="transliteration">FabidunyÄyÄ Wa Ê¾Ä€khiratÄ« Û Ya RasÅ«l AllÄhi Khuth Biyadi 	</div>
      <div class="translation">O leader of the messengers, O my support Û You are Allahâ€™s gateway, my reliance</div>

      <p class="alt">Ù‚ÙÙ€Ù€Ø³ÙÙ€Ù€Ù…Ù‹Ù€Ù€Ø§ Ø¨ÙÙ€Ù€Ø§Ù„Ù€Ù€Ù†ÙÙ‘Ù€Ù€Ø¬Ù’Ù€Ù€Ù…Ù Ø­ÙÙ€Ù€ÙŠÙ€Ù€Ù†Ù Ù‡ÙÙ€Ù€ÙˆÙÙ‰ Û Ù…ÙÙ€Ù€Ø§ Ø§Ù„Ù’Ù€Ù€Ù…ÙÙ€Ù€Ø¹ÙÙ€Ù€Ø§ÙÙÙ€Ù€Ù‰ ÙˆÙ Ø§Ù„Ù€Ù€Ø³ÙÙ‘Ù€Ù€Ù‚ÙÙ€Ù€ÙŠÙ€Ù€Ù…Ù Ø³ÙÙ€Ù€ÙˆÙÙ‰</p>
      <div class="transliteration">Qasaman bil-najmi hÄ«na hawÄ Û Mal-muâ€˜ÄfÄ wÄl-saqÄ«mu sawÄ</div>
      <p class="alt">ÙÙÙ€Ù€Ø§Ø®Ù’Ù€Ù€Ù„ÙÙ€Ù€Ø¹Ù Ø§Ù„Ù’Ù€Ù€ÙƒÙÙ€Ù€ÙˆÙ’Ù†ÙÙ€Ù€ÙŠÙ’Ù€Ù€Ù†Ù Ø¹ÙÙ€Ù€Ù†Ù’Ù€Ù€ÙƒÙ Ø³ÙÙ€Ù€ÙˆÙÙ‰ Û Ø­ÙÙ€Ù€Ø¨ÙÙ‘ Ù…ÙÙ€Ù€ÙˆÙ’Ù„ÙÙ€Ù€Ù‰ Ø§Ù„Ù’Ù€Ù€Ø¹ÙÙ€Ù€Ø±Ù’Ø¨Ù ÙˆÙØ§Ù„Ù’Ù€Ù€Ø¹ÙÙ€Ù€Ø¬ÙÙ€Ù€Ù…Ù</p>
      <div class="transliteration">FakhlÄâ€˜il-kawnayni â€˜anka siwÄ Û HubbÄ« MawlÄl-â€˜urbi wal-â€˜ajami</div>

      <p>Ø³ÙÙ€Ù€ÙŠÙÙ‘Ù€Ù€Ø¯Ù Ø§Ù„Ù€Ù€Ø³ÙÙ‘Ù€Ù€Ù€Ù€Ø§Ø¯ÙØ§ØªÙ Ù…ÙÙ€Ù€Ù†Ù’ Ù…ÙÙ€Ù€Ø¶ÙÙ€Ù€Ø±Ù Û ØºÙÙ€Ù€ÙˆÙ’Ø«Ù Ø£ÙÙ‡Ù’Ù€Ù€Ù„Ù Ø§Ù„Ù’Ù€Ù€Ø¨ÙÙ€Ù€Ø¯Ù’ÙˆÙ ÙˆÙØ§Ù„Ù’Ù€Ù€Ø­ÙÙ€Ù€Ø¶ÙÙ€Ù€Ø±Ù</p>
      <div class="transliteration">Sayyidus-sÄdÄti mÄ«n muá¸arrin Û Ghawthu ahlil-bÄdwi wal-á¸¥aá¸ari</div>
      <p>ØµÙÙ€Ù€Ø§ Ø­ÙÙ€Ù€Ø¨ÙÙ‘ Ø§Ù„Ù’Ø¢ÙŠÙÙ€Ù€Ø§ØªÙ ÙˆÙØ§Ù„Ù€Ù€Ø³ÙÙ‘Ù€Ù€ÙˆÙØ±Ù Û Ù…ÙÙ€Ù€Ù†Ù’Ù€Ù€Ø¨ÙÙ€Ù€Ø¹Ù Ø§Ù„Ù’Ø£ÙØ­Ù’Ù€Ù€ÙƒÙÙ€Ù€Ø§Ù…Ù ÙˆÙØ§Ù„Ù’Ù€Ù€Ø­ÙÙ€Ù€ÙƒÙÙ€Ù€Ù…Ù</p>
      <div class="transliteration">á¹¢aá¸¥ibul-ÄyÄti wÄs-suwari Û Manbaâ€˜ul-aá¸¥kÄmi wÄl-á¸¥ikamÄ«</div>

      <p class="alt">Ù‚ÙÙ€Ù€Ù…ÙÙ€Ù€Ø±ÙŒ Ø·ÙÙ€Ù€Ø§Ø¨ÙÙ€Ù€ØªÙ’ Ø³ÙÙ€Ù€Ø±ÙÙŠÙ€Ù€Ø±ÙØªÙÙ€Ù€Ù‡Ù Û ÙˆÙØ³ÙÙ€Ù€Ø¬ÙÙ€Ù€Ø§ÙŠÙÙ€Ù€Ø§Ù‡Ù ÙˆÙØ³ÙÙ€Ù€ÙŠÙ€Ù€Ø±ÙØªÙÙ€Ù€Ù‡Ù</p>
      <div class="transliteration">Qamrun á¹­abÄt sarÄ«ratuhu Û Wa sajÄyÄhu wÄ sÄ«ratuhu</div>
      <p class="alt">ØµÙÙ€Ù€ÙÙ’Ù€Ù€ÙˆÙØ©Ù Ø§Ù„Ù’Ù€Ù€Ø¨ÙÙ€Ù€Ø§Ø±ÙÙŠ ÙˆÙØ®ÙÙ€Ù€ÙŠÙ€Ù€Ø±ÙØªÙÙ€Ù€Ù‡Ù Û Ø¹ÙÙ€Ù€Ø¯Ù’Ù„Ù Ø£ÙÙ‡Ù’Ù€Ù€Ù„Ù Ø§Ù„Ù’Ù€Ù€Ø­ÙÙ€Ù€Ù„Ù ÙˆÙØ§Ù„Ù’Ù€Ù€Ø­ÙÙ€Ù€Ø±ÙÙ…Ù</p>
      <div class="transliteration">á¹¢afwatul-bÄrÄ« wÄ khÄ«ratuhu Û â€˜Adlu ahlil-á¸¥illi wÄl-á¸¥arami</div>

      <p>Ù…ÙÙ€Ù€Ø§ Ø±ÙØ£ÙØªÙ’ Ø¹ÙÙ€Ù€ÙŠÙ’Ù€Ù€Ù†Ù ÙˆÙÙ„ÙÙ€Ù€ÙŠÙ’Ù€Ù€Ø³Ù ØªÙÙ€Ù€Ø±ÙÙ‰ Û Ù…ÙÙ€Ù€Ø«Ù’Ù€Ù€Ù„Ù Ø·ÙÙ€Ù€Ù‡Ù ÙÙÙ€Ù€ÙŠ Ø§Ù„Ù’Ù€Ù€ÙˆÙØ±ÙÙ‰ Ø¨ÙÙ€Ù€Ø´ÙÙ€Ù€Ø±ÙØ§</p>
      <div class="transliteration">MÄ raâ€™at â€˜aynÅ«n walaysa tarÄ Û Mithla á¹­aha fÄ«l-warÄ bashara</div>
      <p>Ø®ÙÙ€Ù€ÙŠÙ’Ù€Ù€Ø±Ù Ù…ÙÙ€Ù€Ù†Ù’ ÙÙÙ€Ù€ÙˆÙ’Ù‚Ù Ø§Ù„Ù€Ù€Ø«ÙÙ‘Ù€Ù€Ø±ÙÙ‰ Ø£ÙØ«ÙÙ€Ù€Ø±ÙØ§ Û Ø·ÙÙ€Ù€Ø§Ù‡ÙÙ€Ù€Ø±Ù Ø§Ù„Ù’Ø£ÙØ®Ù’Ù€Ù€Ù„ÙØ§Ù‚Ù ÙˆÙØ§Ù„Ù€Ù€Ø´ÙÙ‘Ù€Ù€ÙŠÙÙ€Ù€Ù…Ù</p>
      <div class="transliteration"> Khayru Man FawqÄl-tharÄ atharÄ Û á¹¬ahirul-akhlÄqÄ« wÄsh-shaymÄ«</div>
    </div>

  </div>
  <div id="shareMenu" role="menu" aria-hidden="true">
    <button id="copyLinkButton" type="button">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
    <button id="whatsappShareButton" type="button">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</button>
    <button id="telegramShareButton" type="button">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</button>
  </div>
  <script>
    // Hide chorus box if disable flag is present
    (function() {
      const container = document.querySelector('.container');
      const chorusBox = container.querySelector('.chorus-box');
      if (container.dataset.disableChorus === "false" && chorusBox) {
        chorusBox.style.display = 'none';
      }
    })();
    // Font size functionality for poem paragraphs
    (function() {
      const minFontSize = 1; // in rem
      const maxFontSize = 2.5; // in rem
      let currentFontSize = 1.2; // default as in CSS
      const paragraphs = document.querySelectorAll('.container p');
      function setFontSize(size) {
        size = Math.max(minFontSize, Math.min(maxFontSize, size));
        currentFontSize = size;
        paragraphs.forEach(function(p) {
          p.style.fontSize = size + 'rem';
        });
        applyAlternateLineColour();
      }
      window.changeFontSize = function(delta) {
        setFontSize(currentFontSize + 0.1 * delta);
      };
      // Ensure initial size is set
      setFontSize(currentFontSize);
    })();

    // Alternate line colour functionality
    function applyAlternateLineColour() {
      const paragraphs = document.querySelectorAll('.container p');
      const lightColor = "#256328"; // alternate colour in light mode
      const darkColor = "#53A2A9";  // alternate colour in dark mode
      const isDark = document.body.classList.contains('dark-mode');
      paragraphs.forEach((p) => {
        // Default: normal colour (let CSS handle it)
        p.style.color = '';
        // Only apply alternate colour if .alt class is present
        if (p.classList.contains('alt')) {
          p.style.color = isDark ? darkColor : lightColor;
        }
      });
    }
    applyAlternateLineColour();

    // Dark mode toggle with system preference support
    (function() {
      const toggleButton = document.getElementById('darkModeToggle');
      const darkModeClass = 'dark-mode';

      // Apply system preference on load
      function applySystemPreference() {
        if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.body.classList.add(darkModeClass);
        } else {
          document.body.classList.remove(darkModeClass);
        }
        applyAlternateLineColour();
      }

      applySystemPreference();

      // Listen for changes in system preference
      if(window.matchMedia) {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
          // Only apply system preference if user hasn't toggled manually
          if(!toggleButton.dataset.manualToggle) {
            if(e.matches) {
              document.body.classList.add(darkModeClass);
            } else {
              document.body.classList.remove(darkModeClass);
            }
            applyAlternateLineColour();
          }
        });
      }

      toggleButton.addEventListener('click', function() {
        document.body.classList.toggle(darkModeClass);
        // Mark manual toggle so system preference changes won't override
        toggleButton.dataset.manualToggle = 'true';
        applyAlternateLineColour();
      });
    })();

    // Custom share menu functionality
    (function() {
      const shareButton = document.getElementById('shareButton');
      const shareMenu = document.getElementById('shareMenu');
      const copyLinkButton = document.getElementById('copyLinkButton');
      const whatsappShareButton = document.getElementById('whatsappShareButton');
      const telegramShareButton = document.getElementById('telegramShareButton');

      // Toggle share menu visibility
      shareButton.addEventListener('click', function(event) {
        event.stopPropagation();
        if (shareMenu.style.display === 'flex') {
          shareMenu.style.display = 'none';
          shareMenu.setAttribute('aria-hidden', 'true');
        } else {
          shareMenu.style.display = 'flex';
          shareMenu.setAttribute('aria-hidden', 'false');
        }
      });

      // Hide share menu if clicking outside
      document.addEventListener('click', function() {
        if (shareMenu.style.display === 'flex') {
          shareMenu.style.display = 'none';
          shareMenu.setAttribute('aria-hidden', 'true');
        }
      });

      // Copy link functionality
      copyLinkButton.addEventListener('click', function() {
        const url = window.location.href;
        if (navigator.clipboard && window.isSecureContext) {
          navigator.clipboard.writeText(url).then(() => {
            alert('Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ… Ù†Ø³Ø®Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
            shareMenu.style.display = 'none';
            shareMenu.setAttribute('aria-hidden', 'true');
          }, () => {
            alert('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·.');
          });
        } else {
          // fallback for older browsers
          const textArea = document.createElement("textarea");
          textArea.value = url;
          textArea.style.position = "fixed";
          textArea.style.left = "-999999px";
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();
          try {
            document.execCommand('copy');
            alert('Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ… Ù†Ø³Ø®Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!');
            shareMenu.style.display = 'none';
            shareMenu.setAttribute('aria-hidden', 'true');
          } catch (err) {
            alert('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·.');
          }
          document.body.removeChild(textArea);
        }
      });

      // WhatsApp share functionality
      whatsappShareButton.addEventListener('click', function() {
        const text = encodeURIComponent('Check out this poem: ' + window.location.href);
        const whatsappUrl = 'https://api.whatsapp.com/send?text=' + text;
        window.open(whatsappUrl, '_blank');
        shareMenu.style.display = 'none';
        shareMenu.setAttribute('aria-hidden', 'true');
      });

      // Telegram share functionality
      telegramShareButton.addEventListener('click', function() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent('Check out this poem');
        const telegramUrl = 'https://t.me/share/url?url=' + url + '&text=' + text;
        window.open(telegramUrl, '_blank');
        shareMenu.style.display = 'none';
        shareMenu.setAttribute('aria-hidden', 'true');
      });
    })();

    // Hamburger menu toggle for nav-pane on small screens
    (function() {
      const hamburgerButton = document.getElementById('hamburgerButton');
      const navPane = document.getElementById('navPane');

      hamburgerButton.addEventListener('click', function(event) {
        event.stopPropagation();
        navPane.classList.toggle('show');
      });

      // Hide nav-pane when clicking outside on small screens
      document.addEventListener('click', function() {
        if (navPane.classList.contains('show')) {
          navPane.classList.remove('show');
        }
      });

      // Prevent clicks inside nav-pane from closing it
      navPane.addEventListener('click', function(event) {
        event.stopPropagation();
      });
    })();

    // Translation and transliteration toggle functionality
  document.getElementById("translationToggle").addEventListener("click", () => {
    document.querySelectorAll(".container .translation").forEach(el => {
      el.style.display = (el.style.display === "none" || el.style.display === "") ? "block" : "none";
    });
  });

  document.getElementById("transliterationToggle").addEventListener("click", () => {
    document.querySelectorAll(".container .transliteration").forEach(el => {
      el.style.display = (el.style.display === "none" || el.style.display === "") ? "block" : "none";
    });
  });
    // --- Tag filter and search integration ---
    let poems = [];
    let currentTag = "All";
    let searchTerm = "";

    // Utility: extract unique tags from poems array
    function getUniqueTags(poemArr) {
      const tagSet = new Set();
      poemArr.forEach(poem => {
        if (Array.isArray(poem.tags)) {
          poem.tags.forEach(tag => {
            if (tag && typeof tag === "string") tagSet.add(tag.trim());
          });
        }
      });
      return Array.from(tagSet).sort((a, b) => a.localeCompare(b, 'ar', {sensitivity:'base'}));
    }

    // Render filter buttons inside #tagFilterContainer
    function renderTagFilters(tags) {
      const container = document.getElementById("tagFilterContainer");
      container.innerHTML = "";
      const allBtn = document.createElement("button");
      allBtn.textContent = "All";
      allBtn.className = "filter-button";
      allBtn.dataset.tag = "All";
      container.appendChild(allBtn);
      tags.forEach(tag => {
        const btn = document.createElement("button");
        btn.textContent = tag;
        btn.className = "filter-button";
        btn.dataset.tag = tag;
        container.appendChild(btn);
      });
      // Mark "All" as active by default
      setActiveTagButton(currentTag);
    }

    // Mark active filter button
    function setActiveTagButton(tag) {
      const btns = document.querySelectorAll("#tagFilterContainer .filter-button");
      btns.forEach(btn => {
        if (btn.dataset.tag === tag) {
          btn.classList.add("active");
        } else {
          btn.classList.remove("active");
        }
      });
    }

    // Filtering logic: by tag and search term
    function getFilteredPoems() {
      return poems.filter(poem => {
        // Tag filter
        if (currentTag !== "All") {
          if (!poem.tags || !Array.isArray(poem.tags) || !poem.tags.includes(currentTag)) return false;
        }
        // Search filter
        if (searchTerm) {
          const st = searchTerm.toLowerCase();
          // 1) check title
          if (poem.title && poem.title.toLowerCase().includes(st)) return true;
          // 2) check tags
          if (Array.isArray(poem.tags) && poem.tags.some(tag => tag.toLowerCase().includes(st))) return true;
          // 3) file or id
          if (poem.file && poem.file.toLowerCase().includes(st)) return true;
          if (poem.id && String(poem.id).toLowerCase().includes(st)) return true;
          // If didn't match any above, exclude
          return false;
        }
        return true;
      });
    }

    // Render poems list
    function displayPoems(poemArray) {
      const list = document.getElementById("poemList");
      list.innerHTML = "";
      poemArray.forEach((poem) => {
        const li = document.createElement("li");
        const a = document.createElement("a");
        a.textContent = poem.title;
        // Remove leading 'poems/' if present to avoid duplication
        let href = poem.file;
        if (href.startsWith("poems/")) {
          href = href.slice("poems/".length);
        }
        a.href = href;
        li.appendChild(a);
        list.appendChild(li);
      });
    }

    // Main: load poems, render filters and list
    async function loadPoems() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/youwi-08/qasidacollectionjson/main/poems-list.json');
        if (!response.ok) throw new Error('Failed to load poems list');
        poems = await response.json();
        const tags = getUniqueTags(poems);
        renderTagFilters(tags);
        displayPoems(getFilteredPoems());
        attachTagFilterEvents();
      } catch (err) {
        // fallback: show error in nav
        const list = document.getElementById("poemList");
        list.innerHTML = "<li>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚ØµØ§Ø¦Ø¯</li>";
      }
    }

    // Attach click listeners to tag filter buttons
    function attachTagFilterEvents() {
      const container = document.getElementById("tagFilterContainer");
      container.addEventListener("click", function(e) {
        if (e.target && e.target.classList.contains("filter-button")) {
          const tag = e.target.dataset.tag;
          if (tag !== currentTag) {
            currentTag = tag;
            setActiveTagButton(currentTag);
            displayPoems(getFilteredPoems());
          }
        }
      });
    }

    // Search input event
    document.getElementById("searchInput").addEventListener("input", (e) => {
      searchTerm = e.target.value.trim();
      displayPoems(getFilteredPoems());
    });

    // ğŸ”‘ Call this so poems and filters appear initially
    loadPoems();

  </script>
</body>
</html>